## Huntress CTF 2024 Writeups

Some writeups from the 2024 Huntress CTF

![image](https://github.com/user-attachments/assets/be7b4457-7099-454c-9ded-1ba0f8b468b4)

## **Unbelievable | Warmups 🏃‍♂️ | @JohnHammond**
Don't believe everything you see on the Internet!

Anyway, have you heard this intro soundtrack from Half-Life 3?

Challenge files:
Half-Life_3_OST.mp3 - 0f33ec86710e901eceb6894c96eaab8d88be66f859a4338186e2225a855dcd27



Solution
Verify if the .mp3 file is actually what it claims to be using the file command
```
file Half-Life_3_OST.mp3
```
You see that it is a .png file, so rename it and open it to find the flag as text in the image file
Use an OCR tool/ text extractor to get your flag
```
tesseract file.png flag
```

## **TXT Message | Warmups 🏃‍♂️ | @JohnHammond**
Hmmm, have you seen some of the strange DNS records for the ctf.games domain? One of them sure is odd... 



Solution
Given the challenge name, we need to look for the TXT record for ctf.games
dig TXT ctf.games
```
;; ANSWER SECTION:
ctf.games.              14400   IN      TXT     "146 154 141 147 173 061 064 145 060 067 062 146 067 060 065 144 064 065 070 070 062 064 060 061 144 061 064 061 143 065 066 062 146 144 143 060 142 175"
```

We see an interesting TXT record. Looking at the description we see that od is slanted... there is a Linux command od short for octal dump
Simply decode the octal dump

31337 Linux cmdline method : 
```
printf '\146\154\141\147\173\061\064\145\060\067\062\146\067\060\065\144\064\065\070\070\062\064\060\061\144\061\064\061\143\065\066\062\146\144\143\060\142\175'
```
```
octal_values = [
    146, 154, 141, 147, 173, 61, 64, 145, 60, 67, 62, 146, 67, 60, 65, 144, 64, 65, 70, 
    70, 62, 64, 60, 61, 144, 61, 64, 61, 143, 65, 66, 62, 146, 144, 143, 60, 142, 175
]

# Convert octal values to ASCII characters
decoded = ''.join([chr(int(str(num), 8)) for num in octal_values])
print(ascii_chars_from_octal)
```

## **Whamazon | Warmups 🏃‍♂️ | @JohnHammond**
Wham! Bam! Amazon is entering the hacking business! Can you buy a flag?


Solution
Start the web instance and interact with the web based command line

Trying to buy a flag shows you don't have enough money

Try buy an apple or something else instead and buy a negative value of it

Infinite money glitch

Now buy the flag

Beat the rock paper scissors by choosing scissors (the shop always chooses paper)

Check inventory for the flag

![image](https://github.com/user-attachments/assets/237a1e42-fd04-4c1d-aedd-f9517c529c07)

![image](https://github.com/user-attachments/assets/4cc0bac1-ee6b-48fe-aee8-b87bd2aed61f)

![image](https://github.com/user-attachments/assets/62385aff-fce4-4c7d-9052-6710c4330154)

![image](https://github.com/user-attachments/assets/20f3f53f-1b61-4d79-beca-c4bbded57494)

**## Too Many Bits | Warmups 🏃‍♂️ | @JohnHammond**
What do all these ones and zero's mean!?! We are in the Warmups category after all...

```
01100110 01101100 01100001 01100111 01111011 01100100 00110000 00110001 00110100 00110111 00110001 00110111 00110000 00110010 01100001 00110001 00110000 00110001 00110011 00110100 01100011 01100100 01100001 01100100 00110001 01100100 01100100 01100100 01100101 00110000 00110110 00110110 00110111 00111000 01100110 00110010 01100110 01111101
```

Solution
Convert the binary to text


## **Cattle | Warmups 🏃‍♂️ | @JohnHammond**
I know it's an esoteric challenge for a Capture the Flag, but could you herd these cows for me? 

Challenge files:
cattle - 105e4572d5ec784cef666e52b45c120fab46985539df2373c49f9c684ac7cc93



Solution
Read the file cattle

Notice it has "moo" repeated in  different variations and cases

Google moo cipher and find that cow cipher is being used

Decode the cow cipher

## **MatryoshkaQR | Warmups 🏃‍♂️ | @JohnHammond**
Wow! This is a big QR code! I wonder what it says...?

Challenge files:
qrcode.png - 9dc337224caa057f0f3eb1134defd2c291a295f861a777101b3eb4987b554c0c



Solution
Get the data from the QR code image using a command like:
```
zbarimg image.png
```
The data received is a python raw bytes string
Simply write the raw bytes to a file using python
Get the data from the second QR code:
```
zbarimg decoded.png
```

Solution Script:
```
hex_data = (
    b"\x89PNG\r\n\x1a\n\x00\x00\x00\rIHDR\x00\x00\x00'\x00\x00\x00'\x01\x00\x00\x00\x00\xa4\xd8l\x98\x00\x00\x00\xf5IDATx\x9c\x01\xea\x00\x15\xff\x01\xff\x00\x00\x00\xff\x00\x80\xa2\xd9\x1a\x02\x00\xbe\xe6T~\xfa\x04\xe4\xff\x0fh\x90\x02\x00\x1a\x7f\xdc\x00\x02\x00\xde\x01H\x00\x00\xbe\xd5\x95J\xfa\x04\xc2*\x15`\x08\x00\xff\x9d.\x9f\xfe\x04\xfd#P\xc3\x0b\x02\x97\x0e:\x07d\x04/vIg\x19\x00\xbb\xcd\xf3-\xd2\x02\xfb\xd6d\xb5\x88\x02E\xc7^\xdf\xfc\x00\x84\xfb\x13\xf3J\x02\xfd\x88a\xefD\x00\xc8t$\x90\n\x01\xc7\x01\xee1\xf7\x043Q\x17\x0cH\x01\xa5\x03\x1c6d\x02\r\xf0\xbfV$\x00\xcf\x13d3\x06\x01\xee\x08J\xf5E\x00\x9b\xee\n\xac\xfa\x01\xea|\xf2\xe86\x04\xb3\xc9\x84\xf7\xb4\x02\t\x90U%\x14\x00\xbf g\xa5\xee\x02\xfbH\xf1#4\x00\xff\xa1!;\x86\x02\x81VB\xdf\xfc\x04>\xb1s\x00\x10\x02\xe4>\xab-p\x00\xa2\xc6\xfe\xf6\xee\x04\x00\x05\xcbl5\x02\x1c\xfc\x85;\xd0\x02\xc2\xfb\xe6A\x00\x01\xff\x00\x00\x00\xff\xf9\xdb_g\xf4\x9a\xddH\x00\x00\x00\x00IEND\xaeB`\x82"
)

with open("image.png", "wb") as file:
    file.write(hex_data)
```

## **Mystery | Warmups 🏃‍♂️ | @MichaelOrlino**
Someone sent this to me...
such enigma, such mystery:

rkenr wozec gtrfl obbur bfgma fkgyq ctkvq zeucz hlvwx yyzat zbvns kgyyd sthmi vsifc ovexl zzdqv slyir nwqoj igxuu kdqgr fdbbd njppc mujyy wwcoy

Settings as below:

    3 Rotor Model
    Rotor 1: VI, Initial: A, Ring A
    Rotor 2: I, Initial: Q, Ring A
    Rotor 3: III, Initial L, Ring A
    Reflector: UKW B
    Plugboard: BQ CR DI EJ KW MT OS PX UZ GH




Solution
Use an enigma cipher machine and use the settings provided - example site: https://www.dcode.fr/enigma-machine-cipher

The following message is revealed:
message wrapped in light hidden deeper out of sight locking it more tight anyway your flagis here flag fdfeabcacbebfbadaefbeccaadddbafezzz


## **Zulu | Warmups 🏃‍♂️ | @JohnHammond**
Did you know that zulu is part of the phonetic alphabet?

Challenge files:
Zulu - a1385a40dd63729ed733673e925a62f583eb1b795b90193678bd5899bce77c8ae



Solution
Use the file command to determine that zulu is a compressed archive

Use 7zip to extract the file zulu\~ from the archive; this file contains the flag

## **Unbelievable | Warmups 🏃‍♂️ | @JohnHammond**
You gotta make sure the people who find stuff for you are rewarded well!

Escalate your privileges and uncover the flag.txt in the finder user's home directory.



Solution
Start  and connect to the service

Use the find command chained with grep to get the flag
```
find /home/ -type f -exec grep -E 'flag\{[0-9a-f]{32}' {} \; 2>/dev/null
```

## **GoCrackMe1 | Reverse Engineering 🔃 | @HuskyHacks**
TENNNNNN-HUT!

Welcome to the Go Dojo, gophers in training!

Go malware is on the rise. So we need you to sharpen up those Go reverse engineering skills. We've written three simple CrackMe programs in Go to turn you into Go-binary reverse engineering ninjas!

First up is the easiest of the three. Go get em!

Challenge File:
GoCrackMe1.zip - 5460DF1F9A9708343C7F47FC91AC793C094F0C723C91CFACF3995BAC385891FB (Archive Password: infected)

Solution:
Execute the binary, we received "Access Denied!"

![image](https://github.com/user-attachments/assets/202077cd-6f8c-4fda-8679-f947f47d7f9e)

Load into a disassembler and locate main_main function

Follow the execution flow and note that there's a conditional jump, one set of instructions is to print the string "Access Denied!" so it's very likely that we want to reverse the jump to execute the other instructions

![image](https://github.com/user-attachments/assets/c576ea0f-6f27-4972-b98e-ce92eb447e50)

Load the program into cutter in write mode and reverse the jump. Edit > Reverse Jump

Execute the modified program and receive the flag

![image](https://github.com/user-attachments/assets/47419767-dd0b-4f96-acd1-548242cc9366)
