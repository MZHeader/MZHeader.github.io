## Winos 4.0 Loader - sRDI Shellcode Analysis

Placeholder

Analysis starts with a NSIS installer binary called ToDesk_Setup_4.7.6.3.exe (86758fb6c5aa0093741402302a0478dab94992ff5c8426f2bc24c815cdeec08c).
This is a trojanised installer file which writes the legitimate application to: "C:\Program Files (x86)\Application", as well as a series of shellcode loaders and shellcode executors in "C:\Users\User\AppData\Local" and "C:\Users\User\AppData\Roaming\TrustAsia".

insttect.exe (ecd6742f5107215ed10fb7aebca3c35190e9a2a4022dc019f863abdcdd530fa9) - This is our first shellcode loader, which gets executed from the AppData\Local directory.

Setting a breakpoint at CreateFileA calls we can see that the binary creates a handle to Single.ini, which was written to the same directory.

![image](https://github.com/user-attachments/assets/82a5315e-653b-4291-b306-5e59c2db6e5d)

![image](https://github.com/user-attachments/assets/585ee1e7-8cd0-44ab-ba89-2cd090166349)

Following along until the next VirtualAlloc call, we can see in the ESI / EDI registers that there is a PE file in memory:

![image](https://github.com/user-attachments/assets/6dae1fd8-f9f4-4c5c-b944-0207e79a590e)

![image](https://github.com/user-attachments/assets/62629884-609f-4edf-83e0-70ba48635faa)

![image](https://github.com/user-attachments/assets/9ec325d5-9c80-4701-bdec-c6d88acdf6f4)

We could dump this executable from memory, alternatively, we can use a tool like Binary Refinery to carve the PE from the Single.ini file:

```
ef Single.ini | carve-pe | peek
```

![image](https://github.com/user-attachments/assets/a14519a6-99ee-4415-a072-3c0837c96ad5)

```
ef Single.ini | carve-pe | dump C:\Users\DFIR\Desktop\carved-dll.dll
```
